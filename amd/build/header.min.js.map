{"version":3,"file":"header.min.js","sources":["../src/header.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * JS module for the header.\r\n *\r\n * @module     theme_lexa/header\r\n * @copyright  2024 G J Barnard.\r\n *               {@link https://gjbarnard.co.uk}\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later.\r\n */\r\n\r\nimport log from 'core/log';\r\nimport adjustMenu from 'theme_lexa/primarymoremenu';\r\n\r\n/**\r\n * Function to intialise this module.\r\n *\r\n * @param {int} theFirstHeaderHeight The first header height.\r\n * @param {int} theSecondHeaderHeight The second header height.\r\n */\r\nexport const init = (theFirstHeaderHeight, theSecondHeaderHeight) => {\r\n    /**\r\n     * Scrolled?\r\n     *\r\n     * @type {boolean}\r\n     */\r\n    let scrolled = false;\r\n\r\n    /**\r\n     * First header height.\r\n     *\r\n     * @type {int} In pixels.\r\n     */\r\n    let firstHeaderHeight = 0;\r\n\r\n    /**\r\n     * Second header height.\r\n     *\r\n     * @type {int} In pixels.\r\n     */\r\n    let secondHeaderHeight = 0;\r\n\r\n    /**\r\n     * Window scroll Y.\r\n     *\r\n     * @type {int} In pixels.\r\n     */\r\n    let windowScrollY = 0;\r\n\r\n    /**\r\n     * Body element.\r\n     *\r\n     * @type {element} The body element.\r\n     */\r\n    const body = document.querySelector('body');\r\n\r\n    /**\r\n     * Navbar scrolled.\r\n     *\r\n     * @type {element} The navbar scrolled element.\r\n     */\r\n    const scrolledNavbar = document.querySelector('#lexa-navbar-scrolled');\r\n\r\n    /**\r\n     * Navbar scrolled only.\r\n     *\r\n     * @type {element} The navbar scrolled only element.\r\n     */\r\n    const scrolledOnlyNavbar = document.querySelector('#lexa-navbar-scrolled-only');\r\n\r\n    /**\r\n     * Navbar plugin output first row.\r\n     *\r\n     * @type {element} The navbar plugin output wrapper.\r\n     */\r\n    const npoOne = document.querySelector('#lexa-npo-one');\r\n\r\n    /**\r\n     * Navbar plugin output second row.\r\n     *\r\n     * @type {element} The navbar plugin output wrapper.\r\n     */\r\n    const npoTwo = document.querySelector('#lexa-npo-two');\r\n\r\n    /**\r\n     * Navbar plugin output.\r\n     *\r\n     * @type {element} The navbar plugin output.\r\n     */\r\n    const npo = document.querySelector('#lexa-npo');\r\n\r\n    /**\r\n     * Navbar primary navigation.\r\n     *\r\n     * @type {element} The navbar primary navigation.\r\n     */\r\n    const npn = document.querySelector('#lexa-navbar-primary-navigation ul');\r\n\r\n    /**\r\n     * Sticky header.\r\n     *\r\n     * @param {bool} notfirst True if not the first time called.\r\n     */\r\n    const stickyheader = notfirst => {\r\n        windowScrollY = window.scrollY;\r\n        if (windowScrollY > secondHeaderHeight) {\r\n            // Greater than first row.\r\n            if (!scrolled) {\r\n                body.classList.add('lexascrolled');\r\n                document.documentElement.style.setProperty('--lexa-navbar-pos', secondHeaderHeight + 'px');\r\n                scrolledNavbar.classList.add('fixed-top');\r\n                scrolledOnlyNavbar.classList.remove('d-none');\r\n                if (npo) {\r\n                    npoTwo.appendChild(npo);\r\n                }\r\n                if (npn) {\r\n                    adjustMenu(npn);\r\n                }\r\n                scrolled = true;\r\n            }\r\n        } else {\r\n            if (scrolled) {\r\n                body.classList.remove('lexascrolled');\r\n                scrolledNavbar.classList.remove('fixed-top');\r\n                scrolledOnlyNavbar.classList.add('d-none');\r\n                if (npo) {\r\n                    npoOne.appendChild(npo);\r\n                }\r\n                if (notfirst && npn) {\r\n                    adjustMenu(npn);\r\n                }\r\n                scrolled = false;\r\n            }\r\n            document.documentElement.style.setProperty('--lexa-navbar-pos',\r\n                (secondHeaderHeight + (firstHeaderHeight - windowScrollY)) + 'px');\r\n        }\r\n    };\r\n\r\n    log.debug('Lexa theme header JS init: ' + theFirstHeaderHeight + ' & ' + theSecondHeaderHeight);\r\n    firstHeaderHeight = theFirstHeaderHeight;\r\n    secondHeaderHeight = theSecondHeaderHeight;\r\n\r\n    if (document.readyState !== 'loading') {\r\n        document.addEventListener('scroll', () => {\r\n            stickyheader(true);\r\n        });\r\n        stickyheader(false);\r\n    } else {\r\n        document.addEventListener('DOMContentLoaded', function() {\r\n            document.addEventListener('scroll', () => {\r\n                stickyheader(true);\r\n            });\r\n            stickyheader(false);\r\n        });\r\n    }\r\n};\r\n"],"names":["theFirstHeaderHeight","theSecondHeaderHeight","scrolled","firstHeaderHeight","secondHeaderHeight","windowScrollY","body","document","querySelector","scrolledNavbar","scrolledOnlyNavbar","npoOne","npoTwo","npo","npn","stickyheader","notfirst","window","scrollY","classList","add","documentElement","style","setProperty","remove","appendChild","debug","readyState","addEventListener"],"mappings":";;;;;;;;4LAiCoB,CAACA,qBAAsBC,6BAMnCC,UAAW,EAOXC,kBAAoB,EAOpBC,mBAAqB,EAOrBC,cAAgB,QAOdC,KAAOC,SAASC,cAAc,QAO9BC,eAAiBF,SAASC,cAAc,yBAOxCE,mBAAqBH,SAASC,cAAc,8BAO5CG,OAASJ,SAASC,cAAc,iBAOhCI,OAASL,SAASC,cAAc,iBAOhCK,IAAMN,SAASC,cAAc,aAO7BM,IAAMP,SAASC,cAAc,sCAO7BO,aAAeC,WACjBX,cAAgBY,OAAOC,QACnBb,cAAgBD,mBAEXF,WACDI,KAAKa,UAAUC,IAAI,gBACnBb,SAASc,gBAAgBC,MAAMC,YAAY,oBAAqBnB,mBAAqB,MACrFK,eAAeU,UAAUC,IAAI,aAC7BV,mBAAmBS,UAAUK,OAAO,UAChCX,KACAD,OAAOa,YAAYZ,KAEnBC,kCACWA,KAEfZ,UAAW,IAGXA,WACAI,KAAKa,UAAUK,OAAO,gBACtBf,eAAeU,UAAUK,OAAO,aAChCd,mBAAmBS,UAAUC,IAAI,UAC7BP,KACAF,OAAOc,YAAYZ,KAEnBG,UAAYF,kCACDA,KAEfZ,UAAW,GAEfK,SAASc,gBAAgBC,MAAMC,YAAY,oBACtCnB,oBAAsBD,kBAAoBE,eAAkB,qBAIrEqB,MAAM,8BAAgC1B,qBAAuB,MAAQC,uBACzEE,kBAAoBH,qBACpBI,mBAAqBH,sBAEO,YAAxBM,SAASoB,YACTpB,SAASqB,iBAAiB,UAAU,KAChCb,cAAa,MAEjBA,cAAa,IAEbR,SAASqB,iBAAiB,oBAAoB,WAC1CrB,SAASqB,iBAAiB,UAAU,KAChCb,cAAa,MAEjBA,cAAa"}